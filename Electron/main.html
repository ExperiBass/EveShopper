<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <style>
      body {
        background-color: grey;
      }
      </style>
  </head>
  <body>
    <form>
      Region:<br>
      <input type="text" name="region" id="Region"><br>
      Item:<br>
      <input type="text" name="item" id="Item"><br>
      <input type="radio" name="bOs" id="buyOrSell" value="buy">Buy<br>
      <input type="radio" name="bOs" id="buyOrSell" value="sell">Sell<br>
      <input type = "button"
    value = "Fetch"
    onclick = "getItem()"/>
    </form>
    <p id="name"></p>
    <p id="desc"></p>
    <p id="price"></p>
    <script>
    const axios = require('axios')
    var item;

    function getItem() {
      var iSearch = document.getElementById('Item').value
      var region = document.getElementById('Region').value
      var item; 

      // getting the item ID
      axios.get('https://esi.evetech.net/latest/search/?categories=inventory_type&datasource=tranquility&language=en-us&search=' 
                + iSearch + '&strict=true')
          .then(response => {

            const data = response.data

            item = data.inventory_type[0]
          })
      
          //getting region id
      axios.get('https://esi.evetech.net/latest/search/?categories=region&datasource=tranquility&language=en-us&search=' + region + 
                '&strict=true')
          .then(response => {

            const data = response.data
            const regID = data.region[0]
            const bOs = document.getElementsByName('bOs')
            var buySell;
            
            // checking which radio button was selected
            for (var i = 0, length = bOs.length; i < length; i++) {
              if (bOs[i].checked) {
                // do whatever you want with the checked radio
                buySell = bOs[i].value
                // only one radio can be logically checked, don't check the rest
                break;
              }
            }
            
            // Getting the orders
            axios.get('https://esi.evetech.net/latest/markets/' + regID + '/orders/?datasource=tranquility&order_type=' + buySell +
                      '&page=1&type_id=' + item)
                .then(response => {
                    //document.getElementById('name').innerHTML = data.name 
                    document.getElementById('desc').innerHTML = response.data[0].price
                    console.log(response.data[0].price)
                    //document.getElementById('price').innerHTML = data.price
                })
          })
          .catch(error => {
            console.log(error)
            alert(error)
          })
      }
  document.onkeyup = function(e) {
        if (e.which == 13) {
          getItem()
        }
      }
    </script>
  </body>
</html>