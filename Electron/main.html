<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <style>
      body {
        background-color: grey;
      }
      </style>
  </head>
  <body>
    <form>
      Region:<br>
      <input type="text" name="region" id="Region"><br>
      Item:<br>
      <input type="text" name="item" id="Item"><br>
      <input type="radio" name="bOs" id="buyOrSell" value="buy">Buy<br>
      <input type="radio" name="bOs" id="buyOrSell" value="sell">Sell<br>
      <input type = "button"
    value = "Fetch"
    onclick = "getItem()"/>
    </form>
    <p id="name"></p>
    <p id="desc"></p>
    <p id="price"></p>
    <script>
    const axios = require('axios')

    function getItem() {
      var iSearch = document.getElementById('Item').value
      var region = document.getElementById('Region').value
      var item; // Item ID
      var regID; // Region ID
      var buySell; // Will be either "buy", "sell", or undefined

      // Checking for region and item
      if (region == '') {
        document.getElementById('desc').innerHTML = 'You didn\'t give a region!'
        return;
      }
      if (iSearch == '') {
        document.getElementById('desc').innerHTML = 'You didn\'t give a item to get the prices of!'
        return;
      }

      // getting the item ID
      axios.get('https://esi.evetech.net/latest/search/?categories=inventory_type&datasource=tranquility&language=en-us&search=' 
                + iSearch + '&strict=true')
          .then(response => {

            const data = response.data

            item = data.inventory_type[0]
          })
      
          //getting region id
      axios.get('https://esi.evetech.net/latest/search/?categories=region&datasource=tranquility&language=en-us&search=' + region + 
                '&strict=true')
          .then(response => {

            const data = response.data
            regID = data.region[0]
            const bOs = document.getElementsByName('bOs')
            
            // checking which radio button was selected
            for (var i = 0, length = bOs.length; i < length; i++) {
              if (bOs[i].checked) {
                // do whatever you want with the checked radio
                buySell = bOs[i].value
                
                // only one radio can be logically checked, don't check the rest
                break;
              }
            }
            getOrders(regID, buySell, item)
          })
          .catch(error => {
            console.log(error)
            alert(error)
          })
      }

    function getOrders(regID, buySell, item) {

      // checking if a radio button was pressed
      if (buySell == undefined) {
                document.getElementById('desc').innerHTML = 'Choose either "Buy" or "Sell"!'
                return;
              }
          // Getting the orders
        axios.get('https://esi.evetech.net/latest/markets/' + regID + '/orders/?datasource=tranquility&order_type=' + buySell +
                  '&page=1&type_id=' + item)
            .then(response => {
                var data = response.data
                console.log(data[0].location_id)
                getStations(data)
                //document.getElementById('price').innerHTML = data.price
            })
    }

    function getStations(pData) {
      console.log(pData[0].location_id)
      axios.get('https://esi.evetech.net/latest/universe/names/?datasource=tranquility', 
      [ pData[0].location_id, pData[0].system_id ]) // ERROR: 405
            .then(response => {
              var data = response.data
              console.log(data[0].name + '\n' + data[1].name)
            })
            .catch(error => {
            console.log(error)
            alert(error)
          })
    }
  document.onkeyup = function(e) {
        if (e.which == 13) {
          getItem()
        }
      }
    </script>
  </body>
</html>