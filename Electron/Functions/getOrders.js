module.exports=getOrders;const axios=require("axios"),getStations=require("./getStations"),err=require("./err"),numeral=require("numeral");async function getOrders(e,t,n){const i=document.getElementById("Fetch"),r=document.getElementById("table");let o,a,d="";if(i.disabled=!0,null==e)return Info.innerHTML='Choose either "Buy" or "Sell"!',setTimeout(function(){document.getElementById("Info").innerText=""},4e3),void(i.disabled=!1);if(null==t)return i.disabled=!1,void Error("itemID is undefined!");if(n){for(let e=0;e<n.length;e++)a=n[e],await u();if(""==d)return Info.innerText=`There are no ${e} orders for that in \n                      ${document.getElementById("fedList").value} space!`,setTimeout(function(){document.getElementById("Info").innerText=""},4e3),void(i.disabled=!1);r.innerHTML+=d,i.disabled=!1}else Error("undefined array");async function s(e){return new Promise(t=>setTimeout(t,e))}async function u(){let n,u;await axios.get(`https://esi.evetech.net/latest/markets/${a}/orders/?datasource=tranquility&order_type=${e}&page=1&type_id=${t}`).then(e=>{o=e.data}).catch(e=>{err(e,"Function: getOrders()"),i.disabled=!1});let l=0;for(let t=0;t<o.length;t++,l++){let a,h,c,m,f;try{a=o[t],h=await getStations(a.location_id),c=numeral(a.price).format("0,0.00")+" ISK"}catch(e){return err(e,"Function: getOrders()"),Info.innerText="Uh oh, there was a error! Please try again, and if it continues to happen, open a issue on my GitHub page with this error:"+e,setTimeout(function(){document.getElementById("Info").innerText=""},4e3),void(i.disabled=!1)}switch(null==h&&(h="Private Station"),e){case"buy":n="Remaining Volume",m=a.volume_remain,info=`<tr>\n                  <td>${h}</td>\n                  <td>${c}</td> \n                  <td>${m}</td>\n                  </tr>`;break;case"sell":n="Minimum Volume",f=a.min_volume,info=`<tr><td>${h}</td>\n                  <td>${c}</td>\n                  <td>${f}</td>\n                  </tr>`}switch(r.innerHTML=null==n?"<tr>\n        <th>Station</th>\n        <th>Price</th> \n        <th></th>\n        <th>Add to List</th>":"Remaining Volume"==n?`<tr>\n                          <th>Station</th>\n                          <th>Price</th> \n                          <th>${n}</th>\n                          </tr><input type="button" value="Add To List" id="Add" onClick="addToList(${o[0].type_id})"/>`:`<tr>\n                          <th>Station</th>\n                          <th>Price</th> \n                          <th>${n}</th>\n                          </tr>`,l){case 1:u=".";break;case 2:u="..";break;case 3:u="...";break;default:u="",l=0}Info.innerText=`Fetching orders (this may take a while)${u}`,d+=info,await s(50)}Info.innerText=""}}